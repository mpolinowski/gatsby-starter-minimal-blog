---
date: "2019-06-18"
title: "User Login with Google OAuth2 for Discourse"
categories:
  - LINUX
  - Discourse
---

![Katmandu, Nepal](./photo-kt456d_645dhfh6dgjkhg4_d.jpg)


<!-- TOC -->

- [Creating a new Google Cloud Platform Project](#creating-a-new-google-cloud-platform-project)
- [Setup OAuth2](#setup-oauth2)
- [Verify your Domain](#verify-your-domain)

<!-- /TOC -->


Configure Discourse to allow login and registration with Google OAuth2.


## Creating a new Google Cloud Platform Project

Open the [Google Developer Console](https://console.developers.google.com) and Select to __Create a new Project__:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_01.png)


Fill in the Project Name field, then click on __Create__:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_02.png)


## Setup OAuth2


Under __APIs and Services__ and select the __OAuth consent screen__:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_03.png)


Select __External__ and then click on __Create__:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_04.png)


Fill out the form then click Save:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_05.png)


Go to the __Credentials__ tab on the left, click on __+ CREATE CREDENTIALS__ then click on __OAuth client ID__:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_06.png)


Choose __Web application__ as the Application Type. In the __Authorized JavaScript Origins__ section, add your siteâ€™s base url, including http:// or https://. In the __Authorized Redirect URI__ section, add the base url with `/auth/google_oauth2/callback`. Click the __Create__ button:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_07.png)


The OAuth client dialog will appear with client ID and secret:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_08.png)


In your Discourse site settings, check enable google oauth2 logins, and fill in your google oauth2 client id and google auth2 client secret provided earlier:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_09.png)



## Verify your Domain


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_10.png)


Your site must be registered on [Search Console](https://www.google.com/webmasters/tools)  with an `https://` URL or with the domain name provider verification method __before you can proceed__:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_11.png)


Add your domain to your [Search Console](https://www.google.com/webmasters/tools) properties:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_12.png)


You can now add a HTML Tag to your Discourse page template to verify your ownership over the domain. To do this copy the meta tag Google provides for you:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_13.png)


Go to the Discourse Admin and go to the following page: `Admin>Customize>Themes`, then select __Components__. Click on __Install__, then __+ Create new__:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_14.png)


Give it a meaningful name (i.e. `GoogleSearchConsoleVerification`):


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_15.png)


In your new component, select __Edit CSS/HTML__, under __Custom CSS/HTML__. In the `</head>` section, paste the HTML tag generated by GSC Verification Wizard, then Save this change:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_16.png)


Back in the Theme menu add your new component to your default Discourse theme:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_17.png)


Back in GSC click on __Verify__ to add your domain to your properties:


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_18.png)


Back in the OAuth2 configuration you can now add your verified domain without further issues!


![Using OAuth2 with Discourse](./Discourse_OAuth2_Login_19.png)